<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Mafia - Classic social deduction game">
    <meta name="theme-color" content="#F97316">
    <title>Mafia - Meenit's Playground</title>

    <link rel="stylesheet" href="../css/global.css">
    <link rel="stylesheet" href="../css/mafia.css">
</head>

<body>
    <div class="game-container">

        <!-- SCREEN 1: Setup -->
        <div id="screen-setup" class="screen">
            <div class="screen-header">
                <img src="../images/Mafia Logo.png" alt="Mafia" class="game-logo">
            </div>

            <div class="content-card">
                <h2>Game Setup</h2>

                <!-- Player Count -->
                <div class="form-group">
                    <label class="label-white">Total Players</label>
                    <div class="number-input">
                        <button class="number-btn" id="decrease-players">âˆ’</button>
                        <input type="number" id="player-count-input" value="5" min="5" max="15" readonly>
                        <button class="number-btn" id="increase-players">+</button>
                    </div>
                </div>

                <!-- Player Names -->
                <div class="form-group">
                    <label class="label-white">Player Names</label>
                    <div id="player-names-container"></div>
                </div>

                <!-- Role Selection -->
                <div class="role-distribution">
                    <h3>Role Selection</h3>

                    <!-- God (Fixed) -->
                    <div class="role-row-with-img">
                        <img src="../images/God.png" alt="God" class="role-icon">
                        <div class="role-info">
                            <span class="role-label">God</span>
                            <p class="role-desc">Narrates game, controls flow (Fixed: 1)</p>
                        </div>
                        <span class="role-value">1</span>
                    </div>

                    <!-- Mafia -->
                    <div class="role-row-with-img">
                        <img src="../images/Mafia.png" alt="Mafia" class="role-icon">
                        <div class="role-info">
                            <span class="role-label">Mafia</span>
                            <p class="role-desc">Kill one player each night</p>
                        </div>
                        <div class="number-input-small">
                            <button class="number-btn-small" id="decrease-mafia">âˆ’</button>
                            <input type="number" id="mafia-count" value="1" min="0" max="5" readonly>
                            <button class="number-btn-small" id="increase-mafia">+</button>
                        </div>
                    </div>

                    <!-- Detective -->
                    <div class="role-row-with-img">
                        <img src="../images/Detective.png" alt="Detective" class="role-icon">
                        <div class="role-info">
                            <span class="role-label">Detective</span>
                            <p class="role-desc">Check if one player is Mafia each night</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="detective-toggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <!-- Jester -->
                    <div class="role-row-with-img">
                        <img src="../images/Jester.png" alt="Jester" class="role-icon">
                        <div class="role-info">
                            <span class="role-label">Jester</span>
                            <p class="role-desc">Win if voted out; picks someone to die</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="jester-toggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <!-- Bomber -->
                    <div class="role-row-with-img">
                        <img src="../images/Bomber.png" alt="Bomber" class="role-icon">
                        <div class="role-info">
                            <span class="role-label">Suicide Bomber</span>
                            <p class="role-desc">If eliminated, take someone with you</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="bomber-toggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <!-- Lovers -->
                    <div class="role-row-with-img">
                        <img src="../images/Lover.png" alt="Lover" class="role-icon">
                        <div class="role-info">
                            <span class="role-label">Lovers</span>
                            <p class="role-desc">Linked pair; if one dies, both die (2 players)</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="lover-toggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <!-- Civilians (Auto-calculated) -->
                    <div class="role-row-with-img">
                        <img src="../images/Civilian.png" alt="Civilian" class="role-icon">
                        <div class="role-info">
                            <span class="role-label">Civilians</span>
                            <p class="role-desc">Find and eliminate Mafia members</p>
                        </div>
                        <span class="role-value" id="civilian-count">2</span>
                    </div>
                </div>

                <button class="btn btn-primary btn-full btn-lg mt-xl" id="start-game-btn">Start Game</button>
            </div>

            <!-- Rules Section -->
            <div class="rules-section-footer">
                <h3>ğŸ® How to Play</h3>
                <div class="rules-content">
                    <p><strong>ğŸ¯ Game Flow:</strong></p>
                    <ol>
                        <li>ğŸ‘ï¸ Each player secretly views their role</li>
                        <li>ğŸŒ™ <strong>Night Phase:</strong> God narrates actions</li>
                        <li>â˜€ï¸ <strong>Day Phase:</strong> Players discuss and vote</li>
                        <li>ğŸ”„ Repeat until a team wins</li>
                    </ol>

                    <p><strong>ğŸŒ™ Night Phase Order:</strong></p>
                    <ol>
                        <li><strong>City sleeps:</strong> "Everyone close your eyes"</li>
                        <li><strong>Mafia wakes:</strong> "Mafia open your eyes, choose victim"</li>
                        <li><strong>God saves:</strong> God silently chooses to save someone (once per game)</li>
                        <li><strong>Detective:</strong> "Detective open your eyes, suspect someone" (God nods Yes/No)
                        </li>
                        <li><strong>Lover gives kiss:</strong> Round 1 only - Lover picks partner (stays all game)</li>
                        <li><strong>City wakes:</strong> God announces who died (if saved, no one dies)</li>
                    </ol>

                    <p><strong>âš”ï¸ Special Role Rules:</strong></p>
                    <ul>
                        <li><strong>ğŸ’£ Bomber:</strong> If voted out, can take ANY player with them</li>
                        <li><strong>ğŸ¤¡ Jester:</strong> Wins if voted out; picks someone to die with them</li>
                        <li><strong>ğŸ’• Lover:</strong> Picks partner Round 1; if either dies later, both die</li>
                        <li><strong>ğŸ›¡ï¸ God:</strong> Can save themself OR others (once only)</li>
                    </ul>

                    <p><strong>ğŸ† Win Conditions:</strong></p>
                    <ul>
                        <li>âœ… Civilians win: All Mafia eliminated</li>
                        <li>âœ… Mafia wins: Mafia â‰¥ Civilians</li>
                        <li>âœ… Jester solo win: Gets voted out</li>
                    </ul>
                </div>
            </div>

            <a href="../index.html" class="back-link">â† Back to Games</a>
        </div>

        <!-- REST OF THE SCREENS STAY THE SAME -->

        <!-- SCREEN 2: Pass-Phone Role Viewing -->
        <div id="screen-role-viewing" class="screen hidden">
            <div class="screen-header">
                <h1>Role Assignment</h1>
                <p class="subtitle">Pass the phone around (randomized order)</p>
            </div>

            <div class="content-card">
                <div class="pass-phone-indicator">
                    <p class="label">Next to View</p>
                    <p class="player-name-large" id="next-viewer-name">Player Name</p>
                </div>

                <button class="btn btn-primary btn-full btn-lg" id="reveal-role-btn">ğŸ‘ï¸ Reveal My Role</button>
            </div>
        </div>

        <!-- SCREEN 3: Role Card Display -->
        <div id="screen-role-card" class="screen hidden">
            <div class="role-card-container">
                <div class="role-card">
                    <img src="../images/Civilian.png" alt="Role" class="role-image" id="role-image">
                    <h2 class="role-name" id="role-name">Civilian</h2>
                    <p class="role-description" id="role-description">Find the Mafia and eliminate them!</p>
                </div>

                <button class="btn btn-primary btn-full mt-2xl" id="done-viewing-btn">âœ“ Done (Pass Phone)</button>
            </div>
        </div>

        <!-- SCREEN 4: GM Overview -->
        <div id="screen-gm-overview" class="screen hidden">
            <div class="screen-header">
                <h1>GM Overview</h1>
                <p class="subtitle">All player roles (for God/GM only)</p>
            </div>

            <div class="content-card">
                <div id="all-roles-list"></div>

                <button class="btn btn-success btn-full btn-lg mt-xl" id="start-night-btn">Start Night Phase</button>
            </div>
        </div>

        <!-- SCREEN 5: Night Phase -->
        <div id="screen-night" class="screen hidden">
            <div class="screen-header">
                <h1>ğŸŒ™ Night Phase</h1>
                <p class="subtitle">Round <span id="night-round-number">1</span> - GM speaks aloud</p>
            </div>

            <div class="content-card">
                <div class="night-instructions">
                    <h3>GM Instructions (Read Aloud):</h3>
                    <ol id="night-order-list"></ol>
                </div>

                <button class="btn btn-primary btn-full btn-lg mt-xl" id="start-day-btn">Start Day Phase</button>
            </div>
        </div>

        <!-- SCREEN 6: Day Phase -->
        <div id="screen-day" class="screen hidden">
            <div class="screen-header">
                <h1>â˜€ï¸ Day Phase</h1>
                <p class="subtitle">Round <span id="day-round-number">1</span> - Discussion & Voting</p>
            </div>

            <div class="content-card">
                <p class="info-text">Players discuss and vote to eliminate someone.</p>

                <div class="alive-players-list">
                    <h3>Alive Players (<span id="alive-count">7</span>)</h3>
                    <div id="alive-players-container"></div>
                </div>

                <button class="btn btn-danger btn-full btn-lg mt-xl" id="eliminate-day-btn">Eliminate Voted
                    Player</button>
                <button class="btn btn-ghost btn-full mt-md" id="skip-elimination-btn">Skip (No Elimination)</button>
            </div>
        </div>

        <!-- SCREEN 7: Winner Screen -->
        <div id="screen-winner" class="screen hidden">
            <div class="confetti-container" id="confetti-container"></div>

            <div class="winner-content">
                <div class="trophy-icon">ğŸ†</div>
                <h1 class="winner-title" id="winner-title">Civilians Win!</h1>

                <div class="winner-details">
                    <h3>Final Roles</h3>
                    <div id="final-roles-list"></div>
                </div>

                <button class="btn btn-primary btn-lg mt-2xl" id="play-again-btn">Play Again</button>
                <a href="../index.html" class="btn btn-ghost btn-lg mt-md">Back to Games</a>
            </div>
        </div>

    </div>

    <!-- Elimination Modal -->
    <div id="elimination-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Select Player to Eliminate</h3>
            <div id="elimination-player-list"></div>
            <button class="btn btn-ghost btn-full mt-md" id="cancel-elimination-btn">Cancel</button>
        </div>
    </div>

    <!-- Bomber Target Modal -->
    <div id="bomber-modal" class="modal hidden">
        <div class="modal-content">
            <h3>ğŸ’£ Suicide Bomber Activated!</h3>
            <p class="modal-text">The Suicide Bomber takes someone with them. Select target:</p>
            <div id="bomber-target-list"></div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../js/utils.js"></script>
    <script src="../js/mafia.js"></script>
</body>

</html>